---
title: Feedback
description: Composed feedback form for reporting issues and collecting feedback
author: AF
---

<ComponentPreview name="feedback-demo" description="Feedback component with options, input field, and submit button" className="mb-4" />

Feedback 反馈表单组件用于收集用户反馈，支持多选项按钮、详细描述输入和表单提交，适用于内容举报、问题反馈、满意度调查等场景。

## 概述

- **反馈选项**：支持多个反馈类型选项，用户可快速选择问题类型（默认为多选模式）
- **详细描述**：提供输入框收集详细的反馈信息，可配置 `showInputWhenSelected` 实现仅选中指定选项（如「其他」）时才显示
- **表单提交**：内置提交按钮和表单处理逻辑
- **多选/单选**：支持多选和单选两种模式，默认为多选模式
- **受控/非受控**：支持受控和非受控两种使用模式
- **可关闭**：提供关闭按钮，方便用户退出反馈界面
- **灵活定制**：可自定义标题、选项、占位符和提交按钮文本
- **按需显示输入框**：`showInputWhenSelected` 可配置仅在选中指定选项时显示输入框

## 快速开始

多选模式（默认）：用户可以选择多个反馈选项。

```tsx
import { FeedbackComposed } from "@/registry/wuhan/composed/feedback/feedback";

export function Example() {
  return (
    <FeedbackComposed
      options={[
        { id: "harmful", label: "有害/不安全" },
        { id: "false", label: "信息虚假" },
        { id: "inappropriate", label: "内容不当" },
        { id: "other", label: "其他" },
      ]}
      onSubmit={(data) => {
        console.log("反馈数据:", data);
        // data.selectedIds: 选中的选项 ID 数组
        // data.inputValue: 输入框内容
      }}
    />
  );
}
```

单选模式：用户只能选择一个选项。

```tsx
import { FeedbackComposed } from "@/registry/wuhan/composed/feedback/feedback";

export function Example() {
  return (
    <FeedbackComposed
      multiple={false}
      title="有什么问题?"
      options={[
        { id: "harmful", label: "有害/不安全" },
        { id: "false", label: "信息虚假" },
      ]}
      onSubmit={(data) => {
        console.log("反馈数据:", data);
        // data.selectedId: 选中的选项 ID（单选模式）
        // data.inputValue: 输入框内容
      }}
    />
  );
}
```

## 特性

- **多种反馈类型**：通过选项按钮快速分类问题
- **多选支持**：默认为多选模式，用户可选择多个选项（单选模式需设置 `multiple={false}`）
- **详细信息收集**：输入框支持用户补充详细描述
- **双模式支持**：受控模式用于复杂表单，非受控模式用于简单场景
- **表单验证**：内置表单提交处理，可扩展验证逻辑
- **无障碍支持**：包含适当的 ARIA 标签
- **响应式设计**：自适应不同屏幕尺寸

## 安装

<CodeTabs>

<TabsList>
  <TabsTrigger value="cli">CLI</TabsTrigger>
  <TabsTrigger value="manual">Manual</TabsTrigger>
</TabsList>

<TabsContent value="cli">

```bash
npx shadcn@latest add http://localhost:3000/r/wuhan/feedback.json
```

</TabsContent>

<TabsContent value="manual">

<Steps>

<Step>复制以下代码到你的项目</Step>

<ComponentSource name="feedback" />

<Step>更新导入路径以匹配你的项目设置</Step>

</Steps>

</TabsContent>

</CodeTabs>

## 代码演示

### 基本

基础的反馈组件示例，包含完整的反馈流程。

<ComponentPreview
  name="feedback-demo"
  description="Complete feedback component example"
  className="mb-4"
/>

### 受控模式

使用受控模式管理反馈状态，适合需要外部状态管理的场景。

<ComponentPreview
  name="feedback-controlled"
  description="Controlled feedback with external state"
  className="mb-4"
/>

### 自定义选项

自定义反馈选项，支持不同的业务场景。

<ComponentPreview
  name="feedback-custom-options"
  description="Feedback with custom option labels"
  className="mb-4"
/>

### 定义内容

内容举报场景，包含常见的举报理由选项。

<ComponentPreview
  name="feedback-report"
  description="Content report feedback form"
  className="mb-4"
/>

### 带验证的反馈表单

多选模式下的表单验证示例。

<ComponentPreview
  name="feedback-validated"
  description="Feedback form with validation"
  className="mb-4"
/>

### 异步提交

异步提交反馈数据的示例。

<ComponentPreview
  name="feedback-async"
  description="Feedback with async submit"
  className="mb-4"
/>

### 按需显示输入框

仅当选中「其他」选项时才显示输入框，适用于希望用户在选定预设选项后补充说明的场景。

```tsx
import { FeedbackComposed } from "@/registry/wuhan/composed/feedback/feedback";
import { useRef } from "react";

export function Example() {
  const feedbackRef = useRef<HTMLFormElement>(null);
  return (
    <FeedbackComposed
      ref={feedbackRef}
      title="有什么问题?"
      options={[
        { id: "harmful", label: "有害/不安全" },
        { id: "false", label: "信息虚假" },
        { id: "other", label: "其他" },
      ]}
      submitLabel="确认"
      showInputWhenSelected={["other"]}
      onInputShown={() => {
        feedbackRef.current?.scrollIntoView?.({ behavior: "smooth", block: "end" });
      }}
      onSubmit={(data) => console.log("反馈数据:", data)}
    />
  );
}
```

### 带验证的反馈表单

多选模式下的表单验证示例。

<ComponentPreview
  name="feedback-validated"
  description="Feedback with validation"
  className="mb-4"
/>

### 异步提交

支持异步提交的反馈表单。

<ComponentPreview
  name="feedback-async"
  description="Async feedback submission"
  className="mb-4"
/>

## API

### FeedbackComposed

反馈表单主组件，提供完整的反馈收集界面。

#### Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `title` | `ReactNode` | `"有什么问题?"` | 反馈表单标题 |
| `options` | `FeedbackOption[]` | - | 反馈选项列表（必填） |
| `multiple` | `boolean` | `true` | 是否支持多选模式 |
| `selectedId` | `string` | - | 单选模式：受控模式当前选中的选项 ID |
| `selectedIds` | `string[]` | - | 多选模式：受控模式当前选中的选项 ID 列表 |
| `defaultSelectedId` | `string` | `""` | 单选模式：非受控模式默认选中的选项 ID |
| `defaultSelectedIds` | `string[]` | `[]` | 多选模式：非受控模式默认选中的选项 ID 列表 |
| `onSelect` | `(id: string) => void` | - | 单选模式：选项选择变化时的回调 |
| `onSelectChange` | `(ids: string[]) => void` | - | 多选模式：选项选择变化时的回调 |
| `inputValue` | `string` | - | 受控模式：输入框的当前值 |
| `defaultInputValue` | `string` | `""` | 非受控模式：输入框的默认值 |
| `onInputChange` | `(value: string) => void` | - | 输入框内容变化时的回调 |
| `placeholder` | `string` | `"请输入详细描述..."` | 输入框占位符 |
| `submitLabel` | `ReactNode` | `"提交"` | 提交按钮文本 |
| `showInputWhenSelected` | `string \| string[]` | - | 仅当选中指定选项时显示输入框，如 `["other"]` 表示选中「其他」时才显示，未配置时始终显示 |
| `onInputShown` | `() => void` | - | 输入框由隐藏变为显示时调用，可用于滚动到可视区域等 |
| `onSubmit` | `(payload: { selectedId: string; selectedIds: string[]; inputValue: string }) => void` | - | 表单提交时的回调 |
| `onClose` | `() => void` | - | 关闭按钮点击时的回调 |

#### Example

多选模式（默认）：

```tsx
import { FeedbackComposed } from "@/registry/wuhan/composed/feedback/feedback";

function FeedbackExample() {
  return (
    <FeedbackComposed
      options={[
        { id: "bug", label: "Bug 报告" },
        { id: "feature", label: "功能建议" },
        { id: "question", label: "使用问题" },
      ]}
      onSubmit={(data) => {
        console.log("提交:", data);
        // data.selectedIds: 选中的选项 ID 数组
        // data.selectedId: 空字符串（多选模式）
        // data.inputValue: 输入框内容
      }}
    />
  );
}
```

单选模式：

```tsx
import { FeedbackComposed } from "@/registry/wuhan/composed/feedback/feedback";
import { useState } from "react";

function FeedbackExample() {
  const [selectedId, setSelectedId] = useState("");
  const [inputValue, setInputValue] = useState("");

  return (
    <FeedbackComposed
      multiple={false}
      title="反馈问题"
      options={[
        { id: "bug", label: "Bug 报告" },
        { id: "feature", label: "功能建议" },
        { id: "question", label: "使用问题" },
      ]}
      // 单选模式受控
      selectedId={selectedId}
      onSelect={setSelectedId}
      inputValue={inputValue}
      onInputChange={setInputValue}
      // 提交处理
      onSubmit={(data) => {
        console.log("提交:", data);
        // data.selectedId: 选中的选项 ID
        // data.selectedIds: 空数组（单选模式）
        // data.inputValue: 输入框内容
      }}
      onClose={() => {
        console.log("关闭反馈");
      }}
    />
  );
}
```

### FeedbackOption

反馈选项类型定义。

```tsx
interface FeedbackOption {
  id: string;          // 选项的唯一标识符
  label: ReactNode;    // 选项显示的标签
}
```

## 使用场景

- **内容举报**：用户举报不当内容、虚假信息、有害内容等
- **问题反馈**：收集用户遇到的问题和 Bug 报告
- **功能建议**：收集用户的产品改进建议和新功能需求
- **满意度调查**：收集用户对服务、产品的满意度反馈
- **客服咨询**：用户提交咨询问题的表单
- **质量评价**：对内容、服务质量的评价和意见收集

## 最佳实践

1. **选项设计**：反馈选项应涵盖常见问题类型，并提供"其他"选项
2. **输入引导**：使用清晰的占位符文本引导用户输入详细信息
3. **提交反馈**：提交成功后给予明确的反馈提示
4. **数据验证**：提交前验证必填项，确保收集到有效信息
5. **隐私保护**：明确告知用户数据用途，保护用户隐私
6. **响应及时**：收到反馈后及时响应，提升用户体验

## 注意事项

- `options` 是必填属性，至少需要提供一个选项
- 多选模式（默认）：使用 `selectedIds` / `defaultSelectedIds` 和 `onSelectChange`
- 单选模式：使用 `selectedId` / `defaultSelectedId` 和 `onSelect`
- 受控模式下需要同时提供 `selectedId` / `selectedIds` 和对应的回调函数、`inputValue` 和 `onInputChange`
- 非受控模式下可以使用 `defaultSelectedId` / `defaultSelectedIds` 和 `defaultInputValue` 设置初始值
- `onSubmit` 回调会接收包含 `selectedId`、`selectedIds` 和 `inputValue` 的对象
  - 多选模式下：`selectedIds` 为选中的 ID 数组，`selectedId` 为空字符串
  - 单选模式下：`selectedId` 为选中的 ID，`selectedIds` 为空数组
- 表单提交会自动调用 `preventDefault()`，需要在 `onSubmit` 中处理实际的提交逻辑
- `showInputWhenSelected` 未配置时输入框始终显示；配置后仅当选中指定选项时显示，如 `["other"]` 表示选中「其他」时才显示
- `onInputShown` 在输入框由隐藏变为显示时触发，可用于滚动到可视区域等场景

## 样式定制

组件使用 Tailwind CSS，可以通过原语组件进行完全定制：

```tsx
import {
  FeedbackContainerPrimitive,
  FeedbackHeaderPrimitive,
  FeedbackInputPrimitive,
  FeedbackSubmitButtonPrimitive,
} from "@/registry/wuhan/blocks/feedback/feedback-01";

function CustomFeedback() {
  return (
    <FeedbackContainerPrimitive className="bg-gray-50 rounded-lg">
      <FeedbackHeaderPrimitive 
        title="自定义反馈" 
        className="border-b border-gray-200"
      />
      <FeedbackInputPrimitive 
        placeholder="输入您的反馈..." 
        className="border-2 border-blue-200 focus:border-blue-500"
      />
      <FeedbackSubmitButtonPrimitive className="bg-purple-500 hover:bg-purple-600">
        发送反馈
      </FeedbackSubmitButtonPrimitive>
    </FeedbackContainerPrimitive>
  );
}
```

## 原语组件

Feedback 组件基于以下原语组件构建，可用于需要完全自定义的场景。

### FeedbackContainerPrimitive

反馈容器组件，包含所有反馈内容。

| 参数 | 类型 | 说明 |
| --- | --- | --- |
| `children` | `ReactNode` | 子元素 |
| `onClose` | `() => void` | 关闭回调 |
| `className` | `string` | 自定义样式类名 |

### FeedbackHeaderPrimitive

反馈头部组件，包含标题和关闭按钮。

| 参数 | 类型 | 说明 |
| --- | --- | --- |
| `title` | `ReactNode` | 标题内容 |
| `onClose` | `() => void` | 关闭回调 |
| `className` | `string` | 自定义样式类名 |

### FeedbackInputContainerPrimitive

输入框容器组件。

| 参数 | 类型 | 说明 |
| --- | --- | --- |
| `children` | `ReactNode` | 子元素 |
| `className` | `string` | 自定义样式类名 |

### FeedbackInputPrimitive

反馈输入框组件，复用 sidebar 搜索框样式。

| 参数 | 类型 | 说明 |
| --- | --- | --- |
| `placeholder` | `string` | 占位符文本 |
| `value` | `string` | 输入框值 |
| `onChange` | `(e: ChangeEvent) => void` | 变化回调 |
| `className` | `string` | 自定义样式类名 |

### FeedbackSubmitButtonPrimitive

提交按钮组件，品牌色样式。

| 参数 | 类型 | 说明 |
| --- | --- | --- |
| `children` | `ReactNode` | 按钮文本 |
| `type` | `"submit" \| "button"` | 按钮类型 |
| `className` | `string` | 自定义样式类名 |

### 已废弃的原语

> **注意**：以下组件已废弃，建议使用 `toggle-button` block 中的组件。

- **FeedbackButtonPrimitive** - 已废弃，请使用 `ToggleButtonPrimitive`
- **FeedbackButtonGroupPrimitive** - 已废弃，请使用 `ToggleButtonGroupPrimitive`

原语组件可以在 [registry/wuhan/blocks/feedback/feedback-01.tsx](../../registry/wuhan/blocks/feedback/feedback-01.tsx) 中找到。